import{b as m,t as e,w as p,x as f,H as h,L as g,A as y,B as j,i as E}from"./index-DIth0oIc.js";import{M as N,p as b,u as v,D as P,C as l}from"./useBack-uAQCGYKp.js";import{e as d}from"./expeditionIndex-BBmHlwnS.js";import{u as k,I as c}from"./ItemCardList-BrZolSfb.js";import{o as u,R as a,C as w,l as C,m as T,n as D,B as L}from"./card-CRYRt8Xe.js";import{a as B,g as I,E as S}from"./ErrorBoundary-DAtG3o8H.js";import"./use-dark-mode-mdHJdo6o.js";function R(n){const s=[{type:"exclude",excludeList:[n.currentExpeditionId,...n.excludeList??[]],always:!0},{type:"completion",status:"undone"},{type:"publication",mode:"auto"},{type:"prerequisites",mode:"ready",userProgress:n.userProgress}],o=[{type:"prerequisites",mode:"any"},{type:"completion",allowCompleted:!0,respectExcludeList:!0}];return{count:n.count??3,filters:s,fallbacks:o,selectionStrategy:{type:"random",mode:"uniform"}}}function z({currentExpeditionId:n}){const t=k(),s=m.useMemo(()=>{const o=R({currentExpeditionId:n,userProgress:t});return B(o,{allExpeditions:d,userProgress:t,excludeList:[],environment:"production",seed:I(`expedition-${n}`)})},[n,t]);return s.length===0?null:e.jsxs("section",{className:"mt-12",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-foreground lg:text-2xl",children:"Try These Expeditions Next"}),e.jsx(c,{type:"expedition",items:s,variant:"compact"})]})}function q({content:n,dynamicBlocks:t,inlineComponents:s}){return e.jsx(N,{content:n,dynamicBlocks:t,inlineComponents:s})}function x(n){return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function M({metadata:n}){return e.jsxs("div",{className:"space-y-4 border-b border-divider pb-6 mb-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Created: ",x(n.dateCreated)]}),n.lastUpdated!==n.dateCreated&&e.jsxs("span",{className:"ml-4",children:["Updated: ",x(n.lastUpdated)]})]}),n.credits&&e.jsx("div",{className:"text-sm text-muted-foreground prose prose-sm dark:prose-invert",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:b.sanitize(n.credits)}})})]})}function U({prerequisiteSlugs:n}){if(!n||n.length===0)return null;const t=n.map(s=>d.find(o=>o.slug===s)).filter(s=>s!==void 0);return t.length===0?null:e.jsxs("div",{className:"my-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Prerequisites"}),e.jsx(c,{type:"expedition",items:t,variant:"compact"})]})}function O({currentSlug:n}){const t=d.filter(s=>s.prerequisites?.includes(n));return t.length===0?null:e.jsxs("div",{className:"my-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Expeditions that build on this"}),e.jsx(c,{type:"expedition",items:t,variant:"compact"})]})}const J=({data:n})=>{if(!n||n.status!=="success")return[{title:"Expedition - Puzzlestone Peak"},{name:"description",content:"Guided learning path to master puzzle-solving concepts."}];const t=n.expedition,s=`${t.metadata.title} - Puzzlestone Peak`,o=t.metadata.description||"A guided learning path to master puzzle-solving concepts and techniques.";return[{title:s},{name:"description",content:o},{property:"og:title",content:s},{property:"og:description",content:o},{property:"og:type",content:"article"},{name:"twitter:card",content:"summary"},{name:"twitter:title",content:s},{name:"twitter:description",content:o}]},K=p(function(){const t=h(),s=v(a.EXPEDITIONS);if(t.status==="not-found")return e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:"Expedition Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"The expedition you're looking for doesn't exist or has been moved."}),e.jsx(u,{to:a.EXPEDITIONS,children:"Back to Expedition Library"})]})});if(t.status==="error")return e.jsx(P,{error:t.error,slug:t.slug,backRoute:a.EXPEDITIONS,contentType:"expedition"});const{expedition:o}=t;return e.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-4xl",children:[e.jsx(g,{...s,className:"inline-flex items-center text-link hover:text-link-hover hover:underline mb-6 cursor-pointer",children:"← Back"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-4",children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground sm:flex-1",children:o.metadata.title}),e.jsx(l,{type:"expedition",id:o.metadata.id})]}),e.jsx(M,{metadata:o.metadata}),e.jsx(U,{prerequisiteSlugs:o.metadata.prerequisites}),e.jsx(q,{content:o.content,dynamicBlocks:o.dynamicBlocks,inlineComponents:o.inlineComponents}),e.jsx("div",{className:"flex justify-center my-8",children:e.jsx(l,{type:"expedition",id:o.metadata.id})}),e.jsx(O,{currentSlug:o.slug}),e.jsx(S,{context:"recommendations",children:e.jsx(z,{currentExpeditionId:o.metadata.id})})]})}),Q=f(function(){const t=y(),{slug:s}=j(),[o,$]=m.useState(!1);let r="Expedition Loading Error",i="We encountered a problem loading this expedition.";return E(t)?(t.status===404?(r="Expedition Not Found",i=s?`The expedition "${s}" could not be found. It may have been moved or deleted.`:"The expedition you are looking for does not exist."):(r=`Error ${t.status}`,i="An error occurred while loading this expedition."),t.data?.message||t.statusText):t instanceof Error&&(t.message.includes("parse")?(r="Content Format Error",i="This expedition content has a formatting error and cannot be displayed."):(t.message.includes("network")||t.message.includes("fetch"))&&(r="Content Loading Error",i="Failed to load the expedition content. Please check your connection and try again."),t.message),e.jsx("div",{className:"container mx-auto px-4 py-6 max-w-4xl",children:e.jsxs(w,{className:"border-destructive/50",children:[e.jsx(C,{children:e.jsxs(T,{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl text-destructive",children:"⚠"}),r]})}),e.jsxs(D,{className:"space-y-6",children:[e.jsx("p",{className:"text-muted-foreground",children:i}),s&&e.jsxs("p",{className:"text-sm text-foreground",children:["Expedition slug: ",e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:s})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsx(u,{to:a.EXPEDITIONS,variant:"contained",color:"primary",children:"Back to Expedition Library"}),e.jsx(L,{variant:"outlined",onClick:()=>window.location.reload(),children:"Reload Page"})]}),!1]})]})})});export{Q as ErrorBoundary,K as default,J as meta};
